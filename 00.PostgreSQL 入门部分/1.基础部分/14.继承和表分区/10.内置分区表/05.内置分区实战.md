# 验证内容
```
    该章节主要验证在新增或者删除分区的时候时候回堵塞读写。
```

# 验证环境
## 数据库版本
```
    postgres=# select version();
                                                     version                                                 
    ---------------------------------------------------------------------------------------------------------
     PostgreSQL 11.6 on x86_64-pc-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-36), 64-bit
    (1 row)
```
## 表结构
```
    postgres=# \d+ student
                                                         Partitioned table "public.student"
      Column  |            Type             | Collation | Nullable |               Default               | Storage  | Stats target | Description
    ----------+-----------------------------+-----------+----------+-------------------------------------+----------+--------------+-------------
     id       | bigint                      |           | not null | nextval('student_id_seq'::regclass) | plain    |              |
     name     | text                        |           |          |                                     | extended |              |
     gender   | character(1)                |           |          |                                     | extended |              |
     birthday | timestamp without time zone |           |          |                                     | plain    |              |
    Partition key: RANGE (birthday)
    Partitions: student_birthday_201901 FOR VALUES FROM ('2019-01-01 00:00:00') TO ('2019-02-01 00:00:00')


    postgres=# \d+ student_birthday_201901
                                                       Table "public.student_birthday_201901"
      Column  |            Type             | Collation | Nullable |               Default               | Storage  | Stats target | Description
    ----------+-----------------------------+-----------+----------+-------------------------------------+----------+--------------+-------------
     id       | bigint                      |           | not null | nextval('student_id_seq'::regclass) | plain    |              |
     name     | text                        |           |          |                                     | extended |              |
     gender   | character(1)                |           |          |                                     | extended |              |
     birthday | timestamp without time zone |           |          |                                     | plain    |              |
    Partition of: student FOR VALUES FROM ('2019-01-01 00:00:00') TO ('2019-02-01 00:00:00')
    Partition constraint: ((birthday IS NOT NULL) AND (birthday >= '2019-01-01 00:00:00'::timestamp without time zone) AND (birthday < '2019-02-01 00:00:00'::timestamp without time zone))
    Indexes:
        "student_birthday_201901_pkey" PRIMARY KEY, btree (id)

```

## 表数据
```
    postgres=# select tableoid::regclass, * from student;
            tableoid         | id | name | gender |      birthday       
    -------------------------+----+------+--------+---------------------
     student_birthday_201901 |  1 | 张三 | 男     | 2019-01-17 00:00:00
     student_birthday_201901 |  2 | 李四 | 女     | 2019-01-02 00:00:00

```

# 验证添加分区时是否会阻塞读
## CREATE TABLE  PARTITION OF 方式创建分区
```
步骤一：开启一个事务，执行新增分区操作。
    BEGIN;
    CREATE TABLE student_birthday_201902 PARTITION OF student(id PRIMARY KEY) FOR VALUES FROM ('2019-02-01') TO ('2019-03-01');

步骤二：查看该表上的锁情况
    SELECT relname, locktype, mode, granted
    FROM pg_locks, pg_class
    WHERE pg_locks.relation = pg_class.oid
    AND pg_class.relname like 'student%'

    relname	locktype	mode	                  granted
    student	relation	AccessExclusiveLock	       t

步骤三：查询数据
    1：上面的信息可得
    查询主表
    查询具体的分区表

```

# 验证添加分区时是否会阻塞写
```


```
# 验证删除分区时是否会阻塞读
# 验证删除分区时是否会阻塞写
